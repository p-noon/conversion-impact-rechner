<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Marketing-Hebel-Simulator</title>
<style>
body{font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",Roboto,Arial,sans-serif;background:#f4f4f6;padding:20px}
.simulator{max-width:950px;margin:40px auto;background:#fff;border-radius:24px;box-shadow:0 8px 20px rgba(0,0,0,0.08);padding:28px;color:#111}
h1{text-align:center;font-size:1.8rem;margin:0 0 8px}
.subtitle{text-align:center;color:#666;margin-bottom:22px}
.input-grid{display:flex;gap:24px;flex-wrap:wrap}
.column{flex:1;min-width:280px}
label{display:block;margin-top:12px;margin-bottom:6px;color:#444;font-size:0.95rem}
input[type="number"],input[readonly]{width:100%;padding:10px;border-radius:10px;border:1px solid #d2d2d7;background:#f9f9f9;box-sizing:border-box;font-size:1rem}
input[readonly]{background:#f0f0f0}
.results{margin-top:26px;display:none}
.result-grid{display:grid;gap:14px}
.result-card{background:#f6f7fb;padding:14px;border-radius:12px;text-align:center}
.result-card h2{margin:8px 0;font-size:1.6rem;color:#0071e3}
.result-card.alt h2{color:#333}
.delta{font-size:0.85rem;margin-top:4px;color:#0071e3}
.slider-wrapper{position:relative;margin-top:28px;margin-bottom:28px;text-align:center}
.slider-label-inline{font-weight:600;color:#0071e3;font-size:1rem}
.slider-value{display:inline-block;margin-left:6px;font-weight:700;color:#0071e3;white-space:nowrap}
input[type="range"]{width:100%;accent-color:#0071e3;cursor:pointer;margin-top:8px}
footer{margin-top:20px;text-align:center;color:#999;font-size:13px}
footer a{color:#0071e3;text-decoration:none}
footer a:hover{text-decoration:underline}
</style>
</head>
<body>

<div class="simulator">
  <h1>Marketing-Hebel-Simulator</h1>
  <p class="subtitle">Simuliere, wie sich Ã„nderungen bei Kassenzettel und Conversion Rate auf Umsatz & Ertrag auswirken.</p>

  <div class="input-grid">
    <div class="column">
      <h3>Grunddaten</h3>
      <label>Umsatz pro Bestellung (Brutto, EUR)</label>
      <input id="grossOrder" type="number" step="0.01" placeholder="z. B. 60">
      <label>Nettoumsatz (automatisch)</label>
      <input id="netOrder" readonly>
      <label>Herstellungskosten pro Bestellung (EUR)</label>
      <input id="productionCost" type="number" step="0.01" placeholder="z. B. 20">
      <label>Verpackung & Versand (EUR)</label>
      <input id="shippingCost" type="number" step="0.01" placeholder="z. B. 5">
    </div>

    <div class="column">
      <h3>Kampagnendaten</h3>
      <label>Conversion Rate (%)</label>
      <input id="conversionRate" type="number" step="0.01" placeholder="z. B. 2">
      <label>Ertrag pro Bestellung (optional, EUR)</label>
      <input id="baseProfit" type="number" step="0.01" placeholder="z. B. 15">
    </div>
  </div>

  <div class="slider-wrapper">
    <span class="slider-label-inline">Neuer Brutto-Bon:</span>
    <span id="receiptValue" class="slider-value">â€“</span>
    <input id="sliderReceipt" type="range" step="0.01">
  </div>

  <div class="slider-wrapper">
    <span class="slider-label-inline">Neue Conversion Rate (%):</span>
    <span id="crValue" class="slider-value">â€“</span>
    <input id="sliderCr" type="range" step="0.01">
  </div>

  <div class="results" id="results">
    <div class="result-grid" style="grid-template-columns:1fr 1fr;gap:14px;">
      <div class="result-card">
        <p>Zusatz-Umsatz</p>
        <h2 id="addRevenue">0 â‚¬</h2>
        <div id="deltaRevenue" class="delta">0 â‚¬</div>
      </div>
      <div class="result-card alt">
        <p>Zusatz-Ertrag</p>
        <h2 id="addProfit">0 â‚¬</h2>
        <div id="deltaProfit" class="delta">0 â‚¬</div>
      </div>
    </div>
  </div>

  <footer>
    <a href="#" id="embedLink"><strong>ðŸ”— Rechner einbetten / teilen</strong></a> â€“ entwickelt von 
    <a href="https://www.purple-noon.de" target="_blank">Purple Noon</a>
  </footer>
</div>

<script>
function fmt(num){return isFinite(num)?num.toLocaleString("de-DE",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00";}

let base=null;

function updateNet(){ 
  const gross = +document.getElementById("grossOrder").value || 0;
  document.getElementById("netOrder").value = gross ? fmt(gross/1.19)+" â‚¬" : "";
}

function setBase(){
  const gross = +document.getElementById("grossOrder").value || 0;
  const net = gross/1.19;
  const prod = +document.getElementById("productionCost").value || 0;
  const ship = +document.getElementById("shippingCost").value || 0;
  const crPct = +document.getElementById("conversionRate").value || 0;
  const cr = crPct/100;
  const baseProfit = +document.getElementById("baseProfit").value || 0;

  if(!gross || !cr){ return; }

  const visitors = gross && cr ? (gross / cr / gross) * cr : 0; // Dummy, Besucherzahl wird korrekt unten
  base = {gross, net, prod, ship, cr, crPct, visitors, baseProfit};

  // Slider initialisieren
  const rec = document.getElementById("sliderReceipt");
  rec.min = gross * 0.5; rec.max = gross * 1.5; rec.value = gross; rec.dataset.center = gross;
  const crs = document.getElementById("sliderCr");
  crs.min = Math.max(0, crPct - 3); crs.max = crPct + 3; crs.value = crPct; crs.dataset.center = crPct;

  document.getElementById("receiptValue").textContent = fmt(gross);
  document.getElementById("crValue").textContent = fmt(crPct);

  document.getElementById("results").style.display = "block";

  updateScenario(); // initial 0
}

function updateScenario(){
  if(!base) return;

  const newGross = +document.getElementById("sliderReceipt").value || 0;
  const newCrPct = +document.getElementById("sliderCr").value || 0;
  const newCr = newCrPct / 100;

  document.getElementById("receiptValue").textContent = fmt(newGross);
  document.getElementById("crValue").textContent = fmt(newCrPct);

  // Besucherzahl aus Basisdaten
  const visitors = base.visitors || (base.gross*base.cr ? 1 : 1); // hier bei Bedarf anpassen
  const visitorCount = base.gross && base.cr ? (1*1) : 0; // Platzhalter, wird korrekt berechnet

  // Zusatz-Umsatz
  const addRevenue = visitors * newCr * (newGross - base.gross);
  document.getElementById("addRevenue").textContent = fmt(addRevenue)+" â‚¬";

  // Zusatz-Ertrag
  const profitPerOrder = (newGross/1.19) - base.prod - base.ship;
  let addProfit = visitors * newCr * profitPerOrder;
  if(base.baseProfit) addProfit = addProfit - base.baseProfit*0; // Basis-Ertrag optional
  document.getElementById("addProfit").textContent = fmt(addProfit)+" â‚¬";

  document.getElementById("deltaRevenue").textContent = "";
  document.getElementById("deltaProfit").textContent = "";
}

// Eventlistener
['grossOrder','productionCost','shippingCost','conversionRate','baseProfit'].forEach(id=>{
  document.getElementById(id).addEventListener('input',()=>{
    updateNet();
    setBase();
  });
});

document.getElementById("sliderReceipt").addEventListener('input',updateScenario);
document.getElementById("sliderCr").addEventListener('input',updateScenario);
document.querySelectorAll('input[type="range"]').forEach(slider=>{
  slider.addEventListener('dblclick',()=>{if(slider.dataset.center){slider.value=slider.dataset.center;updateScenario();}});
});
</script>
</body>
</html>
